{% style %}
.visual-container {
    margin-top: 60px;
    width: 100%;
    display: flex;
    justify-content: center;
    position: relative;
    height: 380px;
    overflow: hidden;
    mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
    -webkit-mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
}
  .testimonial-stack-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
  }

  .testimonial-stack-card {
    cursor: default;
  }

  .testimonial-card__header {
    height: 12px;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 0 12px;
    margin-top: 12px;
  }

  .testimonial-card__dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .testimonial-card__dot--red {
    background: #ef4444;
  }

  .testimonial-card__dot--amber {
    background: #f59e0b;
  }

  .testimonial-card__dot--green {
    background: #22c55e;
  }

  .testimonial-card__body {
    cursor: default;
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .testimonial-card__header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .testimonial-card__heading {
    font-size: 14px;
    font-weight: 600;
    color: #6b7280;
  }

  .testimonial-card__badge {
    font-size: 11px;
    font-weight: 500;
    color: #46a07e;
    background: #ecfdf5;
    padding: 2px 10px;
    border-radius: 999px;
  }

  .testimonial-card__content {
    border-radius: 10px;
    border: 1px solid #e5e7eb;
    padding: 14px;
    background: #f9fafb;
    margin-bottom: 10px;
    display: flex;
    gap: 12px;
  }

  .testimonial-card__avatar {
    width: 36px;
    height: 36px;
    border-radius: 999px;
    overflow: hidden;
    flex-shrink: 0;
  }

  .testimonial-card__avatar img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .testimonial-card__details {
    flex: 1;
  }

  .testimonial-card__name-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 4px;
  }

  .testimonial-card__name {
    font-size: 13px;
    font-weight: 600;
    color: #111827;
  }

  .testimonial-card__rating {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: #f59e0b;
  }

  .testimonial-card__rating-icon {
    font-size: 13px;
    color: #f59e0b;
  }

  .testimonial-card__title {
    font-size: 11px;
    color: #9ca3af;
    margin-bottom: 6px;
  }

  .testimonial-card__text {
    font-size: 12px;
    line-height: 1.6;
    color: #4b5563;
  }

  .testimonial-card__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 4px;
    font-size: 11px;
    color: #6b7280;
  }

  .testimonial-card__quote-row {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .testimonial-card__quote-icon {
    font-size: 14px;
    color: #9ca3af;
  }
  .mockup-base {
   position: absolute;
    border-radius: 8px;
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.08);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
    display: flex;
    flex-direction: column;
    overflow: hidden; 
  }
  .mockup-base:first-child{
    width: 320px;
    height: 360px;
    left: 50%;
    transform: translateX(-380px) translateY(40px) rotate(-6deg);
    z-index: 1;
    opacity: 0.9;
    background: #fff;
  }
  .mockup-base:last-child {
    width: 320px;
    height: 360px;
    left: 50%;
    transform: translateX(60px) translateY(40px) rotate(6deg);
    z-index: 1;
    opacity: 0.9;
    background: #fff;
  }

  .mockup-widget {
    width: 360px;
    height: 420px;
    left: 50%;
    transform: translateX(-50%) translateY(30px);
    z-index: 10;
    box-shadow: 0 35px 60px -15px rgba(0, 0, 0, 0.2);
  }
{% endstyle %}

<div class="visual-container testimonial-stack-container">
    {% for block in section.blocks %}
      <div class="mockup-base mockup-widget testimonial-stack-card">
        <div class="mockup-header testimonial-card__header">
          <div class="dot testimonial-card__dot testimonial-card__dot--red"></div>
          <div class="dot testimonial-card__dot testimonial-card__dot--amber"></div>
          <div class="dot testimonial-card__dot testimonial-card__dot--green"></div>
        </div>
        <div class="widget-ui testimonial-card__body">
          <div class="testimonial-card__header-row">
            <div class="testimonial-card__heading">{{ block.settings.card-heading }}</div>
            <div class="testimonial-card__badge">{{ block.settings.card-description }}</div>
          </div>

          <div class="testimonial-card__content">
            <div class="testimonial-card__avatar">
                {{ block.settings.card-image | image_url: width: 32 | image_tag }}
            </div>
            <div class="testimonial-card__details">
              <div class="testimonial-card__name-row">
                <div class="testimonial-card__name">{{ block.settings.card-name }}</div>
                <div class="testimonial-card__rating">
                  <iconify-icon icon="lucide:star" class="testimonial-card__rating-icon"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block;margin:auto}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.12 2.12 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.12 2.12 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.12 2.12 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.12 2.12 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.12 2.12 0 0 0 1.597-1.16z"></path></svg></template></iconify-icon>
                  <span>{{ block.settings.card-rating }}</span>
                </div>
              </div>
              <div class="testimonial-card__title">{{ block.settings.card-title }}</div>
              <div class="testimonial-card__text">
                {{ block.settings.card-testimonial }}
              </div>
            </div>
          </div>

          <div class="testimonial-card__footer">
            <div class="testimonial-card__quote-row">
              <iconify-icon icon="lucide:quote" class="testimonial-card__quote-icon"><template shadowrootmode="open"><style data-style="data-style">:host{display:inline-block;vertical-align:0}span,svg{display:block;margin:auto}</style><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1a6 6 0 0 0 6-6V5a2 2 0 0 0-2-2zM5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1a6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z"></path></svg></template></iconify-icon>
              <span>{{ block.settings.card-quote }}</span>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
</div>



    {% schema %}
    {
        "name": "testimonial-stack",
        "blocks": [
            {
                "type": "card",
                "name": "card",
                "settings": [
                    {
                        "type": "text",
                        "id": "card-heading",
                        "label": "Card Heading",
                        "default": "Why merchants choose Recurpay"
                    },
                    {
                        "type": "text",
                        "id": "card-description",
                        "label": "Card Description",
                        "default": "6,500+ brands"
                    },
                    {
                        "type": "image_picker",
                        "id": "card-image",
                        "label": "Card Image"
                    },
                    {
                        "type": "text",
                        "id": "card-name",
                        "label": "Card Name",
                        "default": "Laura Mendes"
                    },
                    {
                        "type": "range",
                        "id": "card-rating",
                        "label": "Card Rating",
                        "min": 1,
                        "max": 5,
                        "step": 1,
                        "default": 5
                    },
                    {
                        "type": "text",
                        "id": "card-title",
                        "label": "Card Title",
                        "default": "Founder, Meadow & Oak"
                    },
                    {
                        "type": "text",
                        "id": "card-testimonial",
                        "label": "Card Testimonial",
                        "default": "Subscriptions with Recurpay are effortless for our customers and our team. Churn is down 18% and support tickets dropped immediately."
                    },
                    {
                        "type": "text",
                        "id": "card-quote",
                        "label": "Card Quote",
                        "default": "Real merchants, real subscription growth"
                    }
                ]
                

            }
        ],
        "max_blocks": 3,
        "presets": [
            {
                "name": "Testimonial Stack"
            }
        ]
    }
    {% endschema %}